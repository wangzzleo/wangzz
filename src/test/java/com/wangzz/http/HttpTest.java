package com.wangzz.http;

import com.alibaba.fastjson.JSON;
import com.google.common.util.concurrent.ThreadFactoryBuilder;
import org.junit.Test;

import java.util.Arrays;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.concurrent.*;

public class HttpTest {

    @Test
    public void testaaa() throws Exception {
        ThreadFactory threadFactory = new ThreadFactoryBuilder().setNameFormat("demo-pool-%d").build();
        ExecutorService service = new ThreadPoolExecutor(10, 10, 1000, TimeUnit.MILLISECONDS, new LinkedBlockingQueue<>(), threadFactory);

        List<String> strings = Arrays.asList("6215983760009144054", "6217003210012930612", "6236683240002099281", "6236683100001845235", "6236683240002099281", "6217003090011005958", "6217003260002570209", "6217003090011005958", "6217001830032938600", "6217001830032938600", "6217001830032938600", "6222020403020432510", "6227003101360048694", "6217001830032938600", "6227003101360048694", "6217001850015190227", "6227003101360048694", "6236681830001942960", "6217003260002570209", "6236681830001942960", "6217001820027194137", "6227003101360048694", "6236681880000571138", "6217001820027194137", "6236681880000571138", "6217001820027194137", "6236681880000571138", "6217001820027194137", "6217003090011005958", "6217002870051529509", "6236681880000571138", "6217002980101548621", "6217001820004887398", "6217001830032159272", "6217003200004639370", "6217001830032159272", "6227003101360048694", "6236681880000571138", "6217002870029775341", "6217002670008789556", "6217002980101548621", "6217001830032159272", "6217002930101219483", "6236683150000524679", "6217001830032159272", "6236683320009485293", "6217001820027194137", "6217001830032159272", "6217002670008789556", "6217002930101219483", "6236681540008216199", "6217003260002570209", "6236683000001480159", "6236683320009485293", "6217002670008789556", "6236681540008216199", "6232111890000707359", "6236683240002099281", "6217002550002735252", "6217002210014781030", "6236681540018177522", "6217002340023170048", "6217001820027194137", "6227003101360048694", "6217001830032159272", "6217000190006737020", "6227000210070147598", "6217001820027194137", "6217002980101548621", "6217001430012373553", "6217002870001643632", "6236681270001777860", "6222803324851007341", "6227003180040078164", "6236681270001777860", "6217003810001386195", "6217001240006735513", "6236682920002165395", "6217000190006737020", "6217003810001386195", "6236683110005293902", "6217002870001643632", "6217002740027297889", "6217001240006735513", "6217002870005102734", "6217002490005816447", "6217001850002780394", "6217002490005816447", "6217002870005102734", "6217002340023170048", "6217001830032159272", "6217001830032159272", "6227002201433815896", "6217002490005816447", "6217001450005512868", "6217001830032159272", "6217003810001386195", "6217001830032159272", "6217001240012032988", "6217002340023170048", "6217003810001386195", "6236683000001480159", "6236683110005293902", "6236683000001480159", "6217001830032159272", "6227001273650062685", "6217001450005512868", "6217001240012032988", "6217002930101219483", "6217002570008532529", "6217003810082773865", "6217002570008532529", "6217002920108533879", "6217001250007419736", "6217003090005220407", "6217003090011005958", "6217002970106056647", "6227000183010760418", "6236683320007603533", "6227001833630314074", "6227003101360048694", "6217003090005220407", "6236681480011747825", "6236683320007603533", "6217001250007419736", "6217001830032512017", "6217001830032512017", "6236681480011747825", "6217003090005220407", "6217001830032512017", "6232111890000707359", "6236683320007603533", "6236681480011747825", "6236683110005293902", "6236683000001480159", "6217003020110031670", "6236683000001480159", "6217000110017051625", "6217001270017310774", "6236683110005293902", "6217003250000119901", "6217002920123405277", "6217001830032512017", "6217000110017051625", "6236681830001942960", "6217003250000119901", "6217002280002956795", "6227000183010760418", "6217002280002956795", "6217003630003979676", "6217002280002956795", "6217003630003979676", "6227000183010760418", "6217001450001757657", "6217001450001757657", "6217001540002589123", "6217003090011005958", "6217003810018897929", "6232111890000707359", "6217002730006126225", "6217001280606717404", "6217001830032159272", "6217001280606717404", "6217002730006126225", "6217001280606717404", "6217001280606717404", "6217003120013355711", "6217002970107694214", "6217002730006126225", "6236683110005293902", "6236681540005210641", "6236681540005210641", "6217002670003882141", "6227002920110929023", "6227001277511558187", "6217003130009319233", "6227001277511558187", "6217003130009319233", "6236681540005210641", "6236681540008216199", "6217002730006126225", "6217001330013035781", "6217002920125962549", "6217001450005512868", "6227001277511558187", "6217002920125962549", "6217001330013035781", "6217002440001721620", "6217000180013521715", "6217002440001721620", "6217001480000531258", "6217001480000531258", "6217003130009319233", "6217001430007513346", "6217001430007513346", "6217003810054294510", "6217000110015167191", "6217000110015167191", "6217001430007513346", "6217003810054294510", "6217001820037021585", "6217002920123405277", "6217001270016249817", "6217003250000119901", "6217001430007513346", "6217002730006126225", "6217001270016249817", "6217002870061106777", "6217003810054294510", "6217001480000531258", "6217001430007513346", "6217001270016249817", "6217001820037021585", "6217002870061106777", "6227002590450461935", "6217001270016249817", "6217001820037021585", "6217001820037021585", "6217002300000516795", "6236682960002071037", "6217003810054294510", "6217003810054294510", "6217003570001675779", "6236683100001845235", "6236682920003602990", "6230942920001056040", "6210812831000227707", "6217001450005512868", "6236682920003602990", "6210812831000227707", "6236683100001845235", "6217002920136677672", "6217993300088453011", "6217001820007097516", "6217002870085046009", "6217003610002662762", "6217001820007097516", "6210812831000227707", "6236681310001335960", "6222801426041009426", "6217000140024906032", "6217002870085046009", "6236681310001335960", "6217002930104214796", "6236680140000317870", "6217002930104214796", "6217002280002784825", "6236682980001210196", "6222801426041009426", "6236681370001204699", "6217003810013774917", "6227003101360048694", "6236682980001210196", "6236683240002099281", "6217002290003515573", "6217001270016249817", "6236682980001210196", "6217003740000264657", "6217001540003740519", "6236681370001204699", "6236680140000317870", "6232111870000878335", "6217003740000264657", "6236682980001210196", "6217002290003515573", "6236681370001204699", "6214661830125892", "6210812831000227707", "6236682980001210196", "6217001820007097516", "6217000140014024663", "6217003210012930612", "6236682980001210196", "6217003740000058836", "6217001460005456909", "6217003600001335494", "6236683170003417424", "6217000130024054677", "6217003320043603698", "6217000180039070473", "6217003600001335494", "6236683170003417424", "6217003320043603698", "6217001850005825782", "6217002870036086914", "6217002980101548621", "6217002870036086914", "6217002830002099663", "6217003320021615896", "6217001460005456909", "6217003600001335494", "6227002731800539877", "6232111870000878335", "6217001820007097516", "6217002830002099663", "6217002870036086914", "6217001210079769426", "6217000180013521715", "6217002920123405277", "6217002870085046009", "6217000210007146706", "6217001210079769426", "6222801426041009426", "6227003812270236308", "6217003600001335494", "6217003630003979676", "6217000210007146706", "6217001210079769426", "6217002920134313874", "6217003680004472684", "6217003680004472684", "6217002730006126225", "6236684220008470016", "6217002980101548621", "6217002930102182441", "6217002340023170048", "6217001430008814644", "6217003600001335494", "6217993300088453011", "6217000130059394949", "6210812450001041304", "6217001820007097516", "6217003860018310514", "6210812450001041304", "6217003860018310514", "6230943050000145435", "6227003812270236308", "6217001460005456909", "6217001430012373553", "6217002340023170048", "6217001430003257773", "6217001430012373553", "6227003101360048694", "6217003680004472684", "6217001430012373553", "6217000210007146706", "6217001430012373553", "6236684220008470016", "6217003250000119901", "6217002430016395676", "6217001240002436140", "6217002920118844712", "6217000110015167191", "6217003810044549783", "6217003810044549783", "6217002430016395676", "6217000180013521715", "6227003101360048694", "6217001240002436140", "6217001430003257773", "6217002200017640598", "6217001460005456909", "6217001240002436140", "6217001540002589123", "6217002200017640598", "6236682960002940389", "6217002160014879518", "6236682960002940389", "6217002200017640598", "6217002160014879518", "6227002731800539877", "6217001240002436140", "6236683100001845235", "6217004190001352953", "6217000180013521715", "6217002990107205878", "6217004190001352953", "6217000140022019028", "6236682960002940389", "6217004190001352953", "6217002990107205878", "6217000140022019028", "6236683100001845235", "6236680610001807491", "6217001830032159272", "6217001650002777170", "6227007200100187402", "6217001270006916557", "6236680610001807491", "6217001650002777170", "6222801426041009426", "6217000140022019028", "6217002160014879518", "6217002930102182441", "6227007200100187402", "6236680610001807491", "6217001270006916557", "6217003090021427648", "6217001240002436140", "6236681540015795409", "6217002480004146128", "6217003090021427648", "6236683100001845235", "6217003090021427648", "6230943050000145435", "6217003130009319233", "6217001340006435922", "6227001832990195826", "6217001250019066608", "6217003680004472684", "6217002730006126225", "6217001340006435922", "6217003800019820830", "6217000140022019028", "6217001270006916557", "6236681540015795409", "6217001340006435922", "6217001270006916557", "6217001240002436140", "6236680610001807491", "6217002730006126225", "6217001270006916557", "6217002480004146128", "6236681880000571138", "6217001270006916557", "6217002990107205878", "6217003010101301109", "6217001460005456909", "6227004165040449571", "6227000010380435521", "6217003810044882242", "6222803100251007234", "6217003810044882242", "6236681830003343696", "6227004165040449571", "6217003860018310514", "6236684220008470016", "6217002970106056647", "6217001270006916557", "6236681370001204699", "6222803100251007234", "6217002590011471499", "6227004165040449571", "6227002590450461935", "6217001250019066608", "6217001240002436140", "6236681880000571138", "6230943600000080212", "6217001250019066608", "6236681650000970303", "6222803100251007234", "6217002590011471499", "6227000731340016321", "6227002212013698248", "6217002670008789556", "6227002212013698248", "6230943600000080212", "6217001250019066608", "6217001270002090464", "6217002920128882371", "6236681880000571138", "6210812450000995849", "6215983760005015951", "6217002870069113684", "6217004160019085911", "6222803100251007234", "6217001830032512017", "6217001210027874401", "6227003101360048694", "6227001272570077302", "6217002920118844712", "6217002870069113684", "6212841491010050010", "6227001272570077302", "6210812450000995849", "6236680610001622064", "6212841491010050010", "6217002340004749273", "6217001250019066608", "6217002200006013757", "6217003740000058836", "6227002212013698248", "6217001330013035781", "6217002920108533879", "6217003200004639370", "6217002340004749273", "6210812450000995849", "6217002550003081565", "6236683050000854755", "6236681460007726967", "6227001272570077302", "6217004160019085911", "6217001240028510134", "6236681880000571138", "6236681460007726967", "6217001140054995433", "6217001820011778796", "6217001250019066608", "6227003812180726380", "6217001240028510134", "6210812450000995849", "6217001310011427610", "6217001140054995433", "6227001272570077302", "6217002970105849125", "6217004160019085911", "6217002550003081565", "6217002970105849125", "6227002453260097680", "6217001310011427610", "6227001272570077302", "6217002970105849125", "6217001140054995433", "6217001340006435922", "6227002212013698248", "6212841491010050010", "6217004220010604894", "6217003130008736486", "6230943600000080212", "6217004220010604894", "6217001270016249817", "6217003130008736486", "6227002453260097680", "6217002920134313874", "6236682670003215976", "6227002731800539877", "6217002430012585726", "6236683860003318537", "6217002920134313874", "6236680610001622064", "6227001272570077302", "6217001340006435922", "6217001370032731366", "6236680610001622064", "6227001272570077302", "6232111890000707359", "6217001460005456909", "6217001370032731366", "6227001486050196008", "6217002340004749273", "6227000731340016321", "6217001140034739984", "6227001272570077302", "6217003760104172689", "6217001140034739984", "6217000210007146706", "6236681370001204699", "6227001274700084943", "6236683160000600049", "6227001486050196008", "6217001370047240106", "6227001274700084943", "6217001240002436140", "6217001370047240106", "6210812450000995849", "6236682670003215976", "6217003170018053688", "6217001370047240106", "6227003101360048694", "6217001240002436140", "6227002920110929023", "6210810650001942615", "6217001210086867593", "6217002340004749273", "6217002970105849125", "6217002920118482869", "6227001833630314074", "6236683160000600049", "6217002340004749273", "6210810650001942615", "6217002920118482869", "6227003101360048694", "6217002990107205878", "6217001370047240106", "6217001830038562347", "6217004190001352953", "6217001540019066503", "6227001833630314074", "6217001370047240106", "6236683160000600049", "6217004260010927085", "6217001540019066503", "6217007150001998285", "6236682960002940389", "6236680610001622064", "6217000130023476590", "6217001630036981147", "6217004260010927085", "6227001274700084943", "6210812430038005233", "6236680610001807491", "6217001240002436140", "6210812430038005233", "6217000130023476590", "6217002340004749273", "6236680690001758290", "6217000360000217598", "6217001540019066503", "6217003020110031670", "6217007150001998285", "6217000460003613437", "6217000360000217598", "6217000130023476590", "6210812430038005233", "6217002720007436665", "6217000460003613437", "6236680690001758290", "6236680610001622064", "6227003101360048694", "6217001630036981147", "6217003740000058836", "6217003090011005958", "6228480316161657762", "6217001440004659935", "6217002720007436665", "6217000360000217598", "6210812430038005233", "6217001460005456909", "6217003660003837004", "6227001274700084943", "6236683160000600049", "6217004260010927085", "6217000010018726144", "6217000010147871886", "6217001440004659935", "6217000360000217598", "6236681880000571138", "6222802214211744819", "6210812430038005233", "6217000180013521715", "6217001240002436140", "6236681880000571138", "6217004260010927085", "6210810730039906905", "6217002720007436665", "6217001440004659935", "6217003960004560971", "6210812430038005233", "6217002200006013757", "6227002920110929023", "6217002720007436665", "6217000360000217598", "6217003160004392026", "6217000610000425603", "6212841491010050010", "6217002440008780710", "6217002920134313874", "6227002920110929023", "6217000010018726144", "6217001210063190852", "6217001180012928746", "6217000010018726144", "6217003170018053688", "6217003860018310514", "6217002340004749273", "6217007200075830094", "6217004220051546210", "6217000300005037088", "6217001210063190852", "6217007200075830094", "6217007200075830094", "6210810830004399423", "6210812450000995849", "6217002670001219510", "6217003170018053688", "6217003250000119901", "6217004220051546210", "6236681650001974718", "6217000010018726144", "6217001210063190852", "6217000300005037088", "6217001440004659935", "6217001830032512017", "6217001850005825782", "6210810730015237713", "6217003660003837004", "6210810730015237713", "6236681650001974718", "6236681930008861294", "6217002440008780710", "6217003850004412747", "6236681650001974718", "6217002440008780710", "6236681930008861294", "6217002440008780710", "6217003150004752162", "6217002440008780710", "6217000180039070473", "6217002440008780710", "6217002970105849125", "6236681930008861294", "6236681880000571138", "6227000731340016321", "6217000360000217598", "6236681930008861294", "6217002570008532529", "6217003850004412747", "6217000580002590094", "6236682000027611598", "6236681880000571138", "6210810620001720923", "6217000580002590094", "6217000010018726144", "6217003660003837004", "6217000210007146706", "6236681420009147877", "6217001300003307854", "6217001140015576736", "6217001300003307854", "6210810830004399423", "6236681420009147877", "6227003811950390096", "6236682000027611598", "6227001853110007972", "6217003850004412747", "6217001140015576736", "6217001300003307854", "6217001430005273927", "6217003040105951666", "6217001460005456909", "6217002200016641316", "6214672670000477941", "6217002200016641316", "6222801426041009426", "6217007200075830094", "6217002640008480134", "6217001300003307854", "6217001270014736864", "6236681830004414470", "6217002640008480134", "6217000140007950445", "6210810730015237713", "6217002720007436665", "6217001300003307854", "6236681830004414470", "6217003860018310514", "6217000140007950445", "6236684220008470016", "6217001820020114090", "6217001820020114090", "6217002720007436665", "6217000300003098082", "6217000410006559673", "6217001820020114090", "6217002300004867913", "6217002930104214796", "6217002300004867913", "6230942950000011902", "6217002920108533879", "6214672670000477941", "6210810620001720923", "6217000300003098082", "6217001300003307854", "6230942950000011902", "6217002200016641316", "6217001260008161179", "6217001450005512868", "6217001260008161179");

        Map<String, Integer> count = new HashMap<>();
        for (String cardNo:strings) {
            service.execute(() -> {
                String s = HttpClientUtilOld.get("https://ccdcapi.alipay.com/validateAndCacheCardInfo.json?cardNo=" + cardNo + "&cardBinCheck=true");
                Map map = JSON.parseObject(s, Map.class);
                count.put((String)map.get("bank"), (count.get(map.get("bank")) == null ? 0 : count.get(map.get("bank"))) + 1 );
            });
            System.out.println(count);
        }

        Thread.sleep(100000);
    }

}
